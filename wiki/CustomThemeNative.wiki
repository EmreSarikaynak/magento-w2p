#summary Integration of w2p into a custom theme

= Introduction =

This document explains changes you need to make to a custom magento theme to enable our web-to-print extension.

All files listed here can be found in [http://code.google.com/p/magento-w2p/downloads/list an installation package], [http://www.magentocommerce.com/extension/1586 extension] on Magento-Connect or in the [http://code.google.com/p/magento-w2p/source/checkout svn repository].

Every file has the new code divided into several sections. Every section has its sequence number (e.g. ZP-CODE:1) and is enclosed with comments similar to this:

{{{
/****** ZP-CODE:1 Short description of code in the block ******/

some code

/****** ZP-CODE:1 End ******/
}}}

= Files in `app/design/frontend/default/<your_theme_name>/` =

You need to modify some files behind the user interface.

==template/catalog/product/list.phtml==
This file shows products from some category in a grid or list layout.

The new code removes _Add to cart_ button and disables product image resizing. The code is divided into 4 section.

*Sections 1 (list layout) and 3 (grid layout)*: checking if the product has web-to-print features and if it's true then output slightly modified image tag to prevent image resizing. Also it sets maximum width for image throw 'max-width' css rule.

*Sections 2 (list layout) and 4 (grid layout)*: checking if the product has web-to-print features and it is not an already customized product (an order). In this case removing _Add to cart_ button.

==template/catalog/product/view.phtml==
This file shows form for ordering on product page. This form contains product images, product name, product description, product price, etc.

New code checks for web-to-print features in a product. In this case it adds additional options (ajax image preview, colour picker, stock images chooser and support for multipage templates) for the product which are produced from template's xml.

The code is divided into 4 sections.

*Section 1*: checking if a product has web-to-print features then printing tabs component for switching pages in multipage templates.

*Section 2*: checking if s product has web-to-print features then printing text fields, stock images choosers, color pickers.

*Section 3*: checking if a product has web-to-print features then printing _Update preview_ button.

*Section 4*: printing javascript code for a product with web-to-print features.

==template/catalog/product/gallery.phtml==
The purpose of the code in this file is to show gallery of product additional images (in original size) in a separate window.

The purpose of new code is to use proper methods to get correct image urls for the product with web-to-print features. The code is divided into 2 sections.

*Sections 1-2*: checking if the product has web-to-print features and if it's true then getting image url with proper method.

= Functions =

  * `get_product_image ($context, $product)` - outputs slightly modified image tag to prevent image resizing and returns _true_ for products with web-to-print features.
  * `get_page_tabs ($context)` - outputs image tabs for multipage templates.
  * `get_text_fields ($context)` - outputs input fields for products with web-to-print features.
  * `get_image_fields ($context)` - outputs stock images choosers and color pickers for products with web-to-print features.
  * `get_preview_button ($context)` - outputs _Update preview_ button for products with web-to-print features.
  * `get_js ($context)` - outputs javascript code for products with web-to-print features.
  * `get_js_css_includes ($context)` - outputs html tags for including javascript and css external files.
  * `get_preview_images ($context)` - outputs product preview images.
  * `get_gallery_thumb ($context, $product, $image)` - outputs slightly modified image tag to prevent image resizing and returns _true_ for products with web-to-print features.
  * `get_gallery_image ($context)` - outputs slightly modified image tag in gallery popup to prevent image resizing and returns _true_ for products with web-to-print features.

= Files from `skin/frontend/default/zptheme/` =

  * `js/jquery-1.3.2.min.js`, `js/jquery-ui-1.7.2.custom.min.js` - jQuery and jQuery UI libs
  * `js/colorpicker.js`, `css/colorpicker.css` - Colorpicker jQuery plugin
  * `js/jquery-qtip-1.0.0-rc3.min.js` - QTip jQuery plugin
  * `js/jquery.dd.js`, `css/dd.css` - Enhanced dropdown component plugin for jQuery
  * `js/jquery.vchecks.js`, `css/checks.css` - Enhanced checkbox component plugin for jQuery
  * `js/jquery.fancybox-1.2.1.pack.js`, `css/jquery.fancybox.css`, `images/fancybox/*` - FancyBox jQuery plugin
  * `css/zp-style.css` - Additional styles for Magento personalization form
    * Here you can adjust maximum width of preview image (see `'div.zetaprints-template-page div.product-img-box img'` selector)