#summary Order Approval extension description

Order Approval extension allows to organize approval process in Magento shop. Approval process is managed by approvers (a customer with enabled approver role) who are setted by administrator. Also, administrator should set approvers for each customer whose orders need approval.

Approval process sits between customer's shopping cart and checkout process. It means that customer able to add any number products to a shopping cart, delete and modify them in the cart any time without any restrictions. But the same time he can not check out products from the cart while they are not approved.

Every time customer tries to check out his shopping cart, the customer's approver receives notification about unapproved products in the customer's shopping cart. Approver can use link from the e-mail to reach order approval UI where he able to approve customer's products. Customer can check status of approval for every products in his shopping cart and is allowed to check out already approved products from the cart.

== Approval process workflow ==
http://create.ly/gbvkju1s1?a=b.png

= Approval status for cart item =
Item's option 'additional_options' was used to save and show approval status for an item.
This options are showed in Product name column on shopping cart page.

See '_add_notice_to_approved_item' method code in [http://code.google.com/p/magento-w2p/source/browse/branches/ZetaPrints_OrderApproval/app/code/community/ZetaPrints/OrderApproval/controllers/CartController.php app/code/community/ZetaPrints/OrderApproval/controllers/CartController.php] file and code in [https://code.google.com/p/magento-w2p/source/browse/branches/ZetaPrints_OrderApproval/app/code/community/ZetaPrints/OrderApproval/controllers/OnepageController.php app/code/community/ZetaPrints/OrderApproval/controllers/OnepageController.php] file.

= How to create a custom email =
There's an e-mail template editor in M. admin interface (System -> Transactional Emails). There administrators can create new e-mail templates based on original M. templates.

Step 1: Press Add New Template button. Select 'New items to approve' template from list. Select a locale you want to use new template in. Press Load Template button to load content of the template for father editing.

Step 2: Give a name for a new template. Edit its subject and content. After it press Save Template button.

Step 3: Select newly created template in System -> Configuration -> Sales Emails -> Order Approval Tab from a list.

= How to make it work with M. web-to-print extension =
Both Order Approval and web-to-print extensions support each other out of the box. 

=  Total removal of extension =
Separate uninstallation script will be provided later.

= Added or changed M. files =
The extension adds several files (no one was changed) to base theme, such as additional layout and template files to checkout module, some widget templates from admin theme and adds e-mail templates.

List of added files:
  * Files from [http://code.google.com/p/magento-w2p/source/browse/#svn/branches/ZetaPrints_OrderApproval/app/design/frontend/base/default/layout/checkout app/design/frontend/base/default/layout/checkout/] directory
  * [http://code.google.com/p/magento-w2p/source/browse/branches/ZetaPrints_OrderApproval/app/design/frontend/base/default/template/checkout/cart/edit.phtml app/design/frontend/base/default/template/checkout/cart/edit.ptml] file
  * Files from [http://code.google.com/p/magento-w2p/source/browse/#svn/branches/ZetaPrints_OrderApproval/app/design/frontend/base/default/template/checkout/cart/edit app/design/frontend/base/default/template/checkout/cart/edit/] directory
  * Files from [http://code.google.com/p/magento-w2p/source/browse/#svn/branches/ZetaPrints_OrderApproval/app/design/frontend/base/default/template/widget app/design/frontend/base/default/template/widget] directory
  * [http://code.google.com/p/magento-w2p/source/browse/branches/ZetaPrints_OrderApproval/skin/frontend/base/default/css/order-approval/styles.css skin/frontend/base/default/css/order-approval/styles.css] file
  * [http://code.google.com/p/magento-w2p/source/browse/branches/ZetaPrints_OrderApproval/app/locale/en_US/template/email/sales/new-items-to-approve.txt app/locale/en_US/template/email/sales/new-items-to-approve.txt] file

= Re-defined M. classes =
  * Class Mage_Checkout_CartController is re-defined by ZetaPrints_OrderApproval_CartController class.
  Re-defined functions:
    * indexAction ()
  * Class Mage_Checkout_OnepageController is re-defined by ZetaPrints_OrderApproval_OnepageController class
  Re-defined functions:
    * indexAction ()
  * Class Mage_Checkout_Block_Cart is re-defined by ZetaPrints_OrderApproval_Block_Cart class
  Re-defined functions:
    * getItems ()
    * chooseTemplate ()
  * Class Mage_Checkout_Model_Cart is re-defined by ZetaPrints_OrderApproval_Model_Cart
  Re-defined functions:
    * getItems ()
    * getQuoteProductIds ()
    * init ()
    * addProduct ()
    * updateItems ()
    * removeItem ()
    * truncate ()
    * getProductIds ()
  * Class Mage_Sales_Model_Quote is re-defined by ZetaPrints_OrderApproval_Model_Quote
  Re-defined functions:
    * _afterSave ()
    * getItemsCollection()
    * getAllItems ()
    * hasItems ()
    * getItemById ()
    * removeItem ()
    * getAllVisibleItems ()
    * addItem ()
    * getItemByProduct ()
    * collectTotals ()
    * setIsActive ()
  * Class Mage_Sales_Model_Quote_Address is re-defined by Mage_Sales_Model_Quote_Address
  Re-defined functions:
    * getAllItems()