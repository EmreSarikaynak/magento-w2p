#summary Extension configuration guide
#labels Featured,Phase-Deploy
This document describes steps necessary to configure ZetaPrints extension to Magento:
  * Configure Magento attributes
  * Clear Magento cache
  * Run data import utility

== Requirements ==
You are expected to have a functioning Magento with the extension already installed. The extension can be installed manually from [http://code.google.com/p/magento-w2p/source/browse/#svn/trunk/data-import Google Code location] or using [http://www.magentocommerce.com/extension/1586 extension code]. This guide requires a certain level of knowledge about Magento and website hosting. Ask someone qualified to help you.

== Back up ==
Your Magento set up may stop working after making configuration changes. It's a good idea to make a back-up of the code, your current theme and the DB first. Takes 5 mins - saves days.

==Add Magento attributes==
Attributes are added via Magento admin UI. Log in as an administrator and navigate to _Catalog/Attributes/Manage Attributes_. Click on _Add attribute_ button.

http://www.zetaprints.com/help/img/magento_w2p_images/Attribute_add_search.jpg

Leave all attribute properties at default values unless stated otherwise here.
None of these attributes should exist, unless this extension has already been installed. If an attribute already exists and you are not sure how it was configured, delete it and create again as per this manual.

Adding an attribute takes you through 2 screens. 

==== Properties screen ====
Most values are entered into this screen.

http://www.zetaprints.com/help/img/magento_w2p_images/Attribute_add_form.jpg

==== Label / Options screen ====
Fields _Admin_ and _Default Store View_ sit on the second screen. The screen appears automatically when you click _Save_ or you can activate the screen by clicking on _Manage Labels/Options_ in the menu on the left.

http://www.zetaprints.com/help/img/magento_w2p_images/Attribute_add_form_2.jpg

====Attribute for template URL====
Link to the template page on ZetaPrints.
  * Attribute Code: *w2p_link*
  * Admin/Default Store View: *Template URL*

====Attribute for template thumb====
Link to the template's image on ZetaPrints to show on category page.
  * Attribute Code: *w2p_image*
  * Used in product listing: yes
  * Admin/Default Store View: *Template thumb*

====Attribute for template image links====
Link to the template's images on ZetaPrints.
  * Attribute Code: *w2p_image_links*
  * Admin/Default Store View: *Template images*

====Attribute for template created timestamp ====
Date and time when the template was created in ZetaPrints. Used for data matching.
  * Attribute Code: *w2p_created*
  * Admin/Default Store View: *Template created*

====Attribute for template modified timestamp ====
Date and time when the template was last modified in ZetaPrints. Used for data matching.
  * Attribute Code: *w2p_modified*
  * Admin/Default Store View: *Template modified*

====Attribute for template previews (large) ====
Link to the template's images on ZetaPrints.
  * Attribute Code: *w2p_image_large*
  * Admin/Default Store View: *Template previews*

====Attribute for template previews (thumbs) ====
Link to the template's images on ZetaPrints.
  * Attribute Code: *w2p_image_small*
  * Admin/Default Store View: *Template thumbs*

====Attribute for template order flag ====
This attribute indicates that the product is actually a customized instance of a template and should not be shown in the store.
  * Attribute Code: *w2p_isorder*
  * Catalog Input Type for Store Owner: Yes/No
  * Used in product listing: Yes
  * Admin/Default Store View: *Personalized product*

====Attribute for order CDR file ====
Link to CDR file generated with the order. A completed order always has a CDR file.
  * Attribute Code: *w2p_cdr*
  * Admin/Default Store View: *Order CDR*	

====Attribute for order JPG file ====
Link to JPG file generated with the order, if such file is generated. See template config in ZetaPrints.
  * Attribute Code: *w2p_jpg*
  * Admin/Default Store View: *Order JPG*

====Attribute for order PNG file ====
Link to PNG file generated with the order, if such file is generated. See template config in ZetaPrints.
  * Attribute Code: *w2p_png*
  * Admin/Default Store View: *Order PNG*

====Attribute for order GIF file ====
Link to GIF file generated with the order, if such file is generated. See template config in ZetaPrints.
  * Attribute Code: *w2p_gif*
  * Admin/Default Store View: *Order GIF*

====Attribute for order PDF file ====
Link to PDF file generated with the order, if such file is generated. See template config in ZetaPrints.
  * Attribute Code: *w2p_pdf*
  * Admin/Default Store View: *Order PDF*



== Edit attribute set ==
Navigate to _Catalog / Attribute Sets / Manage Attribute Sets_ in the top admin menu. Select _Default_ attribute set.

You will see 2 columns of attributes: _Groups_ and _Unassigned Attributes_. The newly added attributes (w2p_xxx) should be in _Unassigned Attributes_ column. Drag them one by one into _General_ group of attributes.

http://www.zetaprints.com/help/img/magento_w2p_images/Attribute_set_form.jpg

== Configure default ZetaPrints theme ==
A theme cannot be modified automatically during the install. Use the theme provided with the package as the first step and then modify your default theme to work with design personalization.

Navigate to _System/Configuration_ and choose _Design_ tab.
http://www.zetaprints.com/help/img/magento_w2p_images/config_zptheme.jpg
	
== Clear cache ==
Magento requires its cache to be cleared after installing an extension. Go to _System/Cache management_ and clear the cache.

  # In _All Cache_ section, select _Refresh_ from the dropdown.
  # Click _Save cache settings_.
  # Click on _Refresh_ button in Catalog Rewrites row,


== Import data ==
Once the extension is installed and configured you can import the data from your ZetaPrints portal. All your catalogs and templates are imported initially and only new and updated templates on subsequent runs. Data import needs to be initiated manually.

==== Add new profile ====
You need to create a new "profile" for data import. Navigate to _System / Import/Export / Advanced Profiles / Add New Profile_ and create the following profile.
  * *Name*: ZetaPrints data import
  * *Action XML*: copy and paste the XML code below into Action XML text box
{{{
<action type="api/importzp" method="parse"></action>
}}}

==== Configure data import ====
You need to provide [http://www.zetaprints.com/help/about-web-to-print-api/ ZetaPrints API Key] and [http://www.zetaprints.com/help/category/access-url/ URL of your web-to-print portal]. Read more in ZetaPrints_Sync_Settings article.

==== Run data import ====
Complete data import configuration and navigate to _System / Import/Export / Advanced Profiles_. Select _ZetaPrints data import_ profile and click on _Run Profile_ tab on the left. Click _Run Profile in Popup_ button. It will initiate a data importing process which may take several minutes.

Re-run the data import the same way every time you add new templates or change existing ones in ZetaPrints. Data import does not delete templates from Magento even if they were removed from ZetaPrints.

== Setting your outside server ip address ==
You need to set outside server ip address only when you are planning to use Magento personalization form and this ip address doesn't match your server address.

This can happen in several situations, for example, your server is behind a NAT.

In such situation you need to hardcode outside server ip address in `<your_magento_installation>/app/code/local/Biinno/Api/Model/zp_api.php` file.
Open this file, find following lines (it's somewhere at the end of the file):

{{{
//Enter here your outside ip address
//if it's not matching your machine address
//$ip = 'a.b.c.d';
}}}

Uncomment third line and replace _a.b.c.d_ with outside server ip address.

For example:

{{{
//Enter here your outside ip address
//if it doesn't match your server address
$ip = '87.110.2.45';
}}}